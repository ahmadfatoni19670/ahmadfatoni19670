#!/bin/bash

KEYS=(
  "d8242d6b91814bed5816ca58b4f3c1a7"
  "c23f555a037457b903ef3915705c986f"
  "b9aa09f6c7ade30c674c26b643d9b440"
  "b5807e3e16f228862637929fb3863d9e"
  "ae6e43b60934cca41d2c3e3c3910033a"
  "a09c569dad1337c891d63d43496dbaae"
  "81b6a5215ab9ca1c6d92da0d89267ad0"
  "68ba004f34943a55b6665a2632c0a393"
  "63a971057fb7a8499ea8238fe5de8b3e"
  "61bbc6b42ebcbc4d93dfb6b86673290d"
  "472a9a7fa77ecadf2a30c00942f4b522"
  "40e79d14e2beb3292943d49deebc6ed1"
  "2cc2ba904fa7ad5b33f3e2a19b13554e"
  "18a312da1336f86c18a4f38960bcbcda"
  "0dea9aede7e7e8fe00549cf0c96b1809"
  "08aa6af3a00b6665195be36b90dd0c70"
  "e59b2693bbc34c28fe719b3d5e4dd864"
  "09cc876d88216bf5f02b084932a74ee8"
  "99eb39374fc374328348c7555d0be1d7"
  "0d342ac7265c340c04857894b4138fe0"
)

NODE_PAIRS=(
  "11816937"
  "11817054"
  "11817145"
  "11817168"
  "12058383"
  "12058839"
  "12058896"
  "12207244"
  "12207612"
  "12207615"
  "12231958"
  "12258732"
  "12261078"
  "12261099"
  "12323157"
  "12323609"
  "12323612"
  "12323973"
  "12324083"
  "12324085"
  "12324094"
  "12324174"
  "12324190"
  "12386121"
  "12388478"
  "12388897"
  "12403247"
  "12403262"
  "12403640"
  "12403650"
  "12403768"
  "12403886"
  "12403947"
  "12428785"
  "12429208"
  "12429313"
  "12429438"
  "12429460"
  "12458522"
  "12458682"
  "12458802"
  "12484611"
  "12484674"
  "12486300"
  "12487106"
  "12487242"
  "12510042"
  "12510074"
  "12893600"
  "12893637"
  "12893646"
  "12922855"
  "12922986"
  "12945667"
  "12945675"
  "12945681"
  "12945690"
  "12975174"
  "12975190"
  "12975203"
  "12975210"
  "12975211"
  "13007289"
  "13007298"
  "13007319"
  "13007338"
  "13007344"
  "13007346"
  "13007355"
  "13031941"
  "13031942"
  "13031950"
  "13058915"
  "13058954"
  "13058958"
  "13058959"
  "13058962"
  "13058963"
  "13084979"
  "13084981"
  "13085013"
  "13085023"
  "13090325"
  "13115537"
  "13115569"
  "13115597"
  "13145035"
  "13145037"
  "13145040"
  "13145050"
  "13174192"
  "13174202"
  "13174209"
  "13174225"
  "13174227"
  "13174228"
  "13200708"
  "13200740"
  "13200748"
  "13206874"
)

XNODE1=${NODE_PAIRS[$((RANDOM % ${#NODE_PAIRS[@]}))]}
SELECTED_KEY=${KEYS[$((RANDOM % ${#KEYS[@]}))]}

ORIGINAL_HOME=$HOME
LOG_DIR1="$ORIGINAL_HOME/chromium/nexus"
LOG_DIR2="$ORIGINAL_HOME/chromium/datagram"

mkdir -p "$LOG_DIR1" "$LOG_DIR2"

/usr/local/bin/nexus-network start \
  --check-memory \
  --headless \
  --node-id "$NODE1" \
  > "$LOG_DIR1/$NODE1.out" 2>&1 &

export HOME="$ORIGINAL_HOME/chromium/datagram/$SELECTED_KEY"
mkdir -p "$HOME"

/usr/local/bin/datagram run -- -key "$SELECTED_KEY" \
  > "$LOG_DIR2/$SELECTED_KEY.out" 2>&1 &
